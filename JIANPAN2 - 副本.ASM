A0 EQU 28H             ;P3控制键盘
A1 EQU 7EH
A2 EQU 0A2H
A3 EQU 62H
A4 EQU 74H
A5 EQU 61H
A6 EQU 21H
A7 EQU 7AH
A8 EQU 20H
A9 EQU 60H
APLUS EQU 30H
AMINUS EQU 0F7H
AMUL EQU 0DFH
ADIV EQU 0B6H
ABACK EQU 0FFH
AEQU EQU 0FFH
ORG 0000H
GO:MOV R2,#00H         ;R2用以控制数字或者符号的个数
START:
MOV P3,#0FH
BEGIN:
MOV A,P3
RRC A
JNC S0
RRC A
JNC S4
RRC A
JNC S8
RRC A
JNC S12
SJMP START
S0:
MOV R0,#16
SJMP NEXT

S4:
MOV R0,#12
SJMP NEXT

S8:
MOV R0,#8
SJMP NEXT

S12:
MOV R0,#4
SJMP NEXT

NEXT:
MOV P3,#0F0H
LCALL DELAY
MOV A,P3
RLC A
JNC DEC3
RLC A
JNC DEC2
RLC A
JNC DEC1
RLC A
JNC DEC0

SJMP START ;防止在列选之后放松了按钮

DEC0:
SJMP SEAR

DEC1:
DEC R0
SJMP SEAR

DEC2:
DEC R0
DEC R0
SJMP SEAR

DEC3:
DEC R0
DEC R0
DEC R0
SJMP SEAR




SEAR:

;--判断R0，对符号和不同数字进行分类处理-------
;MOV A,R0
;CJNE A,#0AH,ZERO        ;等于10，跳到ZERO
;JC NUM           ;小于10，跳到NUM
;SJMP SYMPOL      ;大于10，跳到SYMPOL



MOV R3,#7FH
BEGIN1:
MOV A,R3
MOV P0,A   ;R3，P0控制位选
;LCALL DELAY
MOV R3,A
MOV DPTR,#TAB
MOV A,R0
DEC A
MOVC A,@A+DPTR
MOV P1,A    ;R0，P1控制段选
SJMP START


TAB:DB A1,A2,A3,A4
    DB A5,A6,A7,A8
    DB A9,A0,AEQU,ABACK
    DB APLUS,AMINUS,AMUL,ADIV

ZERO:MOV R0,#00H
SJMP NUM

NUM:    
SYMPOL:
DELAY:
MOV R5,#100
D1:MOV R6,#100
D2:NOP
DJNZ R6,D2
DJNZ R5,D1
RET
